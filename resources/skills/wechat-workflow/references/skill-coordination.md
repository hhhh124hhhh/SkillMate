# Skills协调调用指南

本文档详细说明如何协调调用公众号相关的各个skills，包括调用时机、输入输出格式和组合模式。

---

## 🎯 Skills概览

### 创作层Skills

| Skill | 功能 | 输入 | 输出 | 调用时机 |
|-------|------|------|------|---------|
| **topic-selector** | 选题推荐 | 话题/领域 | 热点选题列表 | 开始阶段 |
| **title-generator** | 标题生成 | 文章内容 | 候选标题+评分 | 确定选题后 |
| **wechat-writing** | 写作指南 | 文章类型 | 结构框架 | 大纲设计 |
| **style-learner** | 风格学习 | 历史文章 | 风格指南 | 创作前 |
| **ai-writer** | 内容创作 | 大纲+风格 | 文章内容 | 创作阶段 |
| **smart-layout** | 排版优化 | 文章内容 | 排版建议 | 定稿后 |

### 分析层Skills

| Skill | 功能 | 输入 | 输出 | 调用时机 |
|-------|------|------|------|---------|
| **data-analyzer** | 数据分析 | 文章数据 | 分析报告 | 优化阶段 |
| **wechat-article-fetcher** | 文章采集 | 公众号名称 | 文章列表 | 竞品分析 |
| **data-writer** | 数据录入 | 项目信息 | JSON数据 | 项目管理 |

---

## 🔄 标准调用序列

### 序列1：完整创作流程

```
用户输入："帮我写一篇关于GLM-4.7的文章"

调用序列：
┌─────────────────────────────────────────────────────┐
│ 1. topic-selector                                    │
│    输入："GLM-4.7"                                   │
│    输出：热点选题列表["智谱上市"、"vs DeepSeek"等]    │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 2. title-generator                                   │
│    输入："智谱上市、GLM vs DeepSeek"                 │
│    输出：10+候选标题 + 点击率评分                     │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 3. wechat-writing                                    │
│    输入："技术测评类"                                 │
│    输出：7部分框架 + 字数分配                         │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 4. style-learner                                     │
│    输入：用户历史文章5-10篇                           │
│    输出：风格指南（标题、结构、语言、情绪）           │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 5. ai-writer                                         │
│    输入：大纲 + 风格指南                              │
│    输出：完整文章内容（3900字）                       │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 6. smart-layout                                      │
│    输入：文章内容                                     │
│    输出：排版优化建议 + 模板选择                      │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 7. data-writer                                       │
│    输入：项目信息                                     │
│    输出：项目数据JSON                                 │
└─────────────────────────────────────────────────────┘
```

**输出**：
- 项目文件夹
- 完整文章（3900字）
- 优化标题
- 排版建议

---

### 序列2：数据驱动优化

```
用户输入："分析我的文章数据，优化内容策略"

调用序列：
┌─────────────────────────────────────────────────────┐
│ 1. data-analyzer                                     │
│    输入：历史文章数据（阅读量、转发量等）             │
│    输出：分析报告（高阅读量特征、最佳发布时间等）     │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 2. topic-selector                                    │
│    输入：高阅读量文章特征                             │
│    输出：优化选题建议                                 │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 3. title-generator                                   │
│    输入：优化选题                                     │
│    输出：高点击率标题建议                              │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 4. ai-writer                                         │
│    输入：优化选题 + 标题 + 风格                        │
│    输出：优化后的文章                                 │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 5. data-analyzer（验证）                              │
│    输入：新文章                                       │
│    输出：预测效果报告                                  │
└─────────────────────────────────────────────────────┘
```

**输出**：
- 优化选题建议
- 高点击率标题
- 预测效果报告

---

### 序列3：竞品分析

```
用户输入："分析[竞品公众号]的文章策略"

调用序列：
┌─────────────────────────────────────────────────────┐
│ 1. wechat-article-fetcher                             │
│    输入：公众号名称 + cookie/token                    │
│    输出：文章列表（标题+链接）                        │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 2. data-analyzer                                     │
│    输入：竞品文章列表                                 │
│    输出：内容策略分析（选题、标题、发布频率等）       │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 3. style-learner                                     │
│    输入：竞品文章内容                                 │
│    输出：竞品写作风格分析                              │
└─────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────┐
│ 4. title-generator                                   │
│    输入：竞品标题特征                                 │
│    输出：竞品标题优化建议                              │
└─────────────────────────────────────────────────────┘
```

**输出**：
- 竞品内容策略报告
- 竞品写作风格分析
- 优化建议

---

## 🎨 组合模式

### 模式A：热点快速响应

**场景**：突发热点事件，需要快速响应

**组合**：
```
topic-selector（热点追踪）
    ↓
title-generator（快速标题）
    ↓
ai-writer（快速创作）
    ↓
smart-layout（模板排版）
```

**特点**：
- 跳过大纲设计
- 使用标准模板
- 压缩创作时间

---

### 模式B：深度技术文章

**场景**：需要深度分析和专业见解

**组合**：
```
topic-selector（技术热点）
    ↓
wechat-article-fetcher（竞品技术文章）
    ↓
data-analyzer（技术对比）
    ↓
wechat-writing（专业结构）
    ↓
ai-writer（深度创作）
    ↓
smart-layout（专业排版）
```

**特点**：
- 强调数据对比
- 专业技术分析
- 图表丰富

---

### 模式C：系列文章创作

**场景**：同一主题的多篇文章

**组合**：
```
# 第一篇
topic-selector → title-generator → ai-writer → smart-layout
    ↓
# 第二篇（保持风格）
style-learner（从第一篇学习） → title-generator → ai-writer
    ↓
# 第三篇（数据分析）
data-analyzer（前两篇数据） → topic-selector → ai-writer
```

**特点**：
- 风格统一
- 内容连贯
- 数据驱动优化

---

## 📋 输入输出格式规范

### topic-selector

**输入**：
```json
{
  "topic": "GLM-4.7",
  "domain": "AI工具",
  "time_range": "7天",
  "platform": ["微博", "知乎", "百度"]
}
```

**输出**：
```json
{
  "hot_topics": [
    {
      "title": "智谱上市579亿",
      "heat": 95,
      "trend": "上升",
      "keywords": ["智谱", "上市", "GLM"]
    }
  ],
  "recommendation": "智谱上市 + GLM vs DeepSeek对比"
}
```

---

### title-generator

**输入**：
```json
{
  "topic": "智谱上市579亿",
  "style": "数据冲击+情绪张力",
  "target_audience": "开发者",
  "count": 10
}
```

**输出**：
```json
{
  "titles": [
    {
      "title": "智谱上市579亿！我凭GLM斩获黑客松奖",
      "score": 92,
      "features": ["热点", "获奖背书", "数据冲击"]
    }
  ]
}
```

---

### style-learner

**输入**：
```json
{
  "articles": ["文章1路径", "文章2路径", ...],
  "analysis_dimensions": ["标题", "结构", "语言", "情绪"]
}
```

**输出**：
```json
{
  "style_profile": {
    "title": ["痛点+解决方案", "数据冲击"],
    "structure": ["热点引入→干货→建议"],
    "language": ["真实", "硬核", "实用"],
    "emotion": ["炸裂", "超神"]
  }
}
```

---

### ai-writer

**输入**：
```json
{
  "outline": "7部分大纲",
  "style_guide": "风格指南",
  "word_count": 3900,
  "tone": "专业+通俗"
}
```

**输出**：
```json
{
  "content": "完整文章内容",
  "word_count": 3900,
  "sections": 7
}
```

---

## ⚠️ 错误处理

### Skill调用失败

**现象**：某个skill无法调用

**处理**：
1. 检查skill是否存在
2. 查看skill的SKILL.md
3. 提供降级方案：
   - topic-selector失败 → 手动提供选题
   - title-generator失败 → 使用默认标题模板
   - style-learner失败 → 使用通用风格

### 数据格式不匹配

**现象**：输出格式与预期不符

**处理**：
1. 检查输入参数是否完整
2. 尝试默认参数
3. 记录错误日志
4. 提供手动补填选项

### 输出质量不达标

**现象**：生成内容不符合要求

**处理**：
1. 调整输入参数
2. 提供更多示例
3. 多轮迭代优化
4. 人工审核把关

---

## 🎯 最佳实践

### 1. 渐进式调用

不要一次性调用所有skills，而是：
1. 先调用选题类skill
2. 用户确认后，再调用标题类skill
3. 逐步推进，每步都给用户确认机会

### 2. 缓存中间结果

将每个skill的输出保存到项目文件夹：
- `00_背景资料.md`：保存选题结果
- `01_文章大纲.md`：保存标题和结构
- `02_文章内容.md`：保存创作内容

### 3. 灵活调整

根据实际情况调整调用顺序：
- 如果用户已有标题，跳过title-generator
- 如果用户已有大纲，跳过wechat-writing
- 如果时间紧张，压缩部分环节

### 4. 质量把控

关键节点需要人工确认：
- 标题选择
- 核心观点
- 重要数据
- 最终定稿

---

## 📊 性能优化

### 并行调用

某些skills可以并行调用：
```
title-generator ┐
               ├→ 并行 → 汇总结果
style-learner ┘
```

### 缓存复用

复用之前的结果：
- 风格指南（多篇文章通用）
- 热点选题（7天内有效）
- 排版模板（同类型文章）

### 智能推荐

基于历史数据推荐：
- 最佳发布时间
- 高点击率标题特征
- 高阅读量内容类型

---

## ✅ 验证清单

Skill调用完成后检查：

- [ ] 所有必要skills都已调用
- [ ] 输入输出格式正确
- [ ] 中间结果已保存
- [ ] 输出质量达标
- [ ] 用户已确认关键节点
- [ ] 项目文件结构完整

---

## 📚 参考资源

- 各skill的SKILL.md文档
- Skills目录：`D:/tcb/.claude/skills/`
- 示例项目：`D:/tcb/公众号项目/`

---

**文档版本**：v1.0
**最后更新**：2026-01-11
