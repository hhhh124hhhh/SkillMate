# SkillMate 测试清单

## 📋 测试前准备

### 环境检查
- [ ] Node.js 版本正确（运行 `node -v`）
- [ ] 依赖已安装（`node_modules` 存在）
- [ ] 配置文件正确（`.env` 文件存在，使用占位符 API Key）

---

## 1️⃣ 开发模式测试

### 启动应用
```bash
npm start
```

### 窗口测试
- [ ] **应用启动成功**：Electron 窗口自动打开
- [ ] **自定义标题栏显示正常**：窗口控制按钮（最小化/最大化/关闭）可用
- [ ] **窗口大小正确**：900x750 像素，最小 800x650
- [ ] **窗口图标正确**：SkillMate 图标显示在任务栏和标题栏

### 主界面测试
- [ ] **Chat 模式**：聊天界面正常显示
- [ ] **Work 模式**：工作模式切换正常
- [ ] **侧边栏**：会话列表、设置按钮显示正常
- [ ] **消息输入框**：可以输入文字
- [ ] **粘贴图片**：可以粘贴截图/图片（Ctrl+V）

### AI 对话测试
- [ ] **发送消息**：输入文字后点击发送，消息显示在聊天区域
- [ ] **流式响应**：AI 回复逐字显示（不是一次性全部显示）
- [ ] **MCP 工具调用**：AI 可以使用内置 MCP 工具（文件系统、网页抓取等）
- [ ] **技能系统**：AI 可以调用技能（写作助手、数据分析等）
- [ ] **错误处理**：API Key 无效时显示错误提示

### 设置面板测试
- [ ] **打开设置**：点击设置按钮打开设置面板
- [ ] **API 配置**：可以配置 Anthropic API Key
- [ ] **模型选择**：可以选择不同的 AI 模型
- [ ] **保存配置**：设置保存后重启应用仍然有效

### 权限确认测试
- [ ] **文件写入权限**：AI 尝试写入文件时弹出权限确认对话框
- [ ] **命令执行权限**：AI 尝试执行命令时弹出权限确认对话框
- [ ] **允许/拒绝**：点击允许或拒绝按钮正确响应

### 悬浮球测试
- [ ] **全局快捷键**：按 `Alt+Space` 打开/关闭悬浮球
- [ ] **悬浮球显示**：小窗口正常显示
- [ ] **展开动画**：从圆形向左展开成矩形窗口
- [ ] **独立进程**：悬浮球和主窗口独立运行

### 数据持久化测试
- [ ] **会话保存**：关闭应用后重新打开，聊天历史仍在
- [ ] **多会话管理**：可以创建和切换多个会话
- [ ] **会话删除**：可以删除不需要的会话

---

## 2️⃣ 打包程序测试

### 打包验证
```bash
npm run package
```

### 文件检查
- [ ] **应用程序存在**：`out/SkillMate-win32-x64/SkillMate.exe`
- [ ] **文件大小合理**：约 169MB（主程序）
- [ ] **资源文件正确**：
  - [ ] `mcp-templates.json` 存在于 `resources/` 目录
  - [ ] `skills/` 目录包含 27 个技能
  - [ ] `python-runtime/` 目录存在

### 安全检查
```bash
# 检查无 API Key 泄露
grep -a "sk-ant-" out/SkillMate-win32-x64/resources/app.asar
# 应该无输出

# 检查无 .env 文件
find out/SkillMate-win32-x64 -name ".env"
# 应该无输出

# 检查 preload.cjs 存在
npx asar list out/SkillMate-win32-x64/resources/app.asar | grep "electron/preload.cjs"
# 应该找到文件
```

- [ ] **无 API Key 泄露**：app.asar 中无真实 API Key
- [ ] **无 .env 文件**：打包产物中不包含 .env
- [ ] **preload.cjs 存在**：预加载脚本正确打包

---

## 3️⃣ 打包程序运行测试

### ⚠️ 重要：先禁用 Device Guard

#### 方法 1：临时禁用 HVCI（推荐）
1. **打开设置**：Windows 设置 → 更新和安全 → Windows 安全
2. **设备安全性**：点击"设备安全性"
3. **核心隔离**：点击"核心隔离详细信息"
4. **关闭内存完整性**：关闭开关
5. **重启计算机**

#### 方法 2：添加 Windows Defender 排除项
1. **打开 Windows 安全中心** → 病毒和威胁防护
2. **管理设置** → 病毒和威胁防护设置
3. **排除项** → 添加或删除排除项
4. **添加排除项**：添加 `out/SkillMate-win32-x64/` 目录

#### 方法 3：使用虚拟机
在没有启用 HVCI 的虚拟机中测试

### 启动测试
- [ ] **双击运行**：双击 `SkillMate.exe` 可以启动应用
- [ ] **无错误提示**：不显示"Device Guard 阻止"错误
- [ ] **托盘图标**：应用启动后显示在系统托盘
- [ ] **主窗口显示**：主窗口自动显示或点击托盘图标显示

### 功能测试（同开发模式）
- [ ] 窗口显示正常
- [ ] AI 对话功能正常
- [ ] MCP 工具可用
- [ ] 技能系统正常
- [ ] 设置可以配置
- [ ] 权限确认弹窗正常
- [ ] 悬浮球快捷键可用
- [ ] 会话数据持久化

### 性能测试
- [ ] **启动时间**：应用在 10 秒内启动
- [ ] **内存占用**：运行时内存占用 < 500MB
- [ ] **响应速度**：UI 响应及时，无明显卡顿

---

## 4️⃣ 跨平台测试（可选）

### macOS 测试
```bash
# 在 macOS 上打包
npm run package -- --platform=darwin --arch=x64
```
- [ ] `.app` 文件可以启动
- [ ] 功能正常（同 Windows 测试清单）

### Linux 测试
```bash
# 在 Linux 上打包
npm run package -- --platform=linux --arch=x64
```
- [ ] AppImage/二进制文件可以启动
- [ ] 功能正常（同 Windows 测试清单）

---

## 5️⃣ 边缘情况测试

### 错误处理
- [ ] **网络断开**：无网络时启动应用，显示友好错误提示
- [ ] **API Key 无效**：配置错误的 API Key，显示错误提示
- [ ] **文件权限不足**：尝试访问无权限目录，显示错误提示
- [ ] **超大文件**：上传超大图片，应用不崩溃

### 数据迁移
- [ ] **旧版本升级**：从旧版本升级，数据正常迁移
- [ ] **配置兼容性**：旧配置文件仍然有效

---

## 6️⃣ 回归测试

### 核心功能验证
- [ ] AI 对话核心流程完整
- [ ] MCP 集成正常工作
- [ ] 技能系统正常运行
- [ ] 数据持久化正确
- [ ] UI 响应正常

### 已修复问题验证
- [ ] mcp-templates.json 正确加载
- [ ] preload.cjs 正确加载
- [ ] 窗口显示问题已修复
- [ ] 无 API Key 泄露

---

## 7️⃣ 性能基准

### 启动性能
- 开发模式：`< 5 秒`
- 打包程序：`< 10 秒`

### 运行时性能
- 内存占用：`< 500MB`
- CPU 占用：空闲时 `< 5%`
- 磁盘占用：安装包 `< 200MB`

---

## ✅ 测试完成标准

### 最小可用产品 (MVP)
- [x] 应用可以启动（开发模式）
- [ ] 基本 AI 对话功能正常
- [ ] MCP 工具可以调用
- [ ] 可以保存配置和会话
- [ ] 打包程序可以在至少一台机器上运行

### 发布标准
- [ ] 所有核心功能测试通过
- [ ] 无严重 bug（崩溃、数据丢失）
- [ ] 性能达标（启动 < 10 秒，内存 < 500MB）
- [ ] 安全检查通过（无 API Key 泄露）
- [ ] 至少在 2 台不同机器上测试通过

---

## 📝 测试记录模板

### 测试环境
- **操作系统**：Windows 11 Pro 23H2
- **Device Guard**：已启用 / 已禁用
- **Node.js 版本**：v20.x.x
- **测试日期**：2026-01-31

### 测试结果
| 测试项 | 结果 | 备注 |
|--------|------|------|
| 应用启动 | ✅ / ❌ | |
| AI 对话 | ✅ / ❌ | |
| MCP 工具 | ✅ / ❌ | |
| 技能系统 | ✅ / ❌ | |
| 数据持久化 | ✅ / ❌ | |
| 打包程序运行 | ✅ / ❌ | |

### 发现的问题
1. 问题描述
   - 复现步骤
   - 预期行为
   - 实际行为
   - 截图/日志

---

## 🐛 问题反馈

如果测试中发现问题，请记录：
1. **问题描述**：简洁描述问题
2. **复现步骤**：如何触发问题
3. **预期行为**：应该怎样
4. **实际行为**：实际怎样
5. **错误信息**：控制台错误或弹窗信息
6. **环境信息**：操作系统、Device Guard 状态等

---

**测试完成后，请将结果反馈给开发团队！**
